{% extends 'base.html' %}
{% load static %}

{% block title %}Î¤Î¹ Î´ÎµÎ½ ÎšÎ±Î»ÏÏ€Ï„ÎµÎ¹ - Hoolie Pet Insurance{% endblock %}

{% block content %}
<section class="hero-section">
    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title" style="font-size: 2.5rem; margin-bottom: 1rem; color: var(--brand-primary);">
                Î¤Î¹ Î´ÎµÎ½ ÎšÎ±Î»ÏÏ€Ï„ÎµÎ¹ Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î±; ğŸ”
            </h1>
            
            <p class="hero-subtitle" style="font-size: 1.2rem; margin-bottom: 2rem; opacity: 0.9; text-align: center; max-width: 800px; margin-left: auto; margin-right: auto;">
                Î£Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Hoolie Insurance Î´ÎµÎ½ Î­Ï‡Î¿Ï…Î¼Îµ Ï„Î¯Ï€Î¿Ï„Î± Î½Î± ÎºÏÏÏˆÎ¿Ï…Î¼Îµ. Î Î¹ÏƒÏ„ÎµÏÎ¿Ï…Î¼Îµ ÏŒÏ„Î¹ ÎµÎ¯Î½Î±Î¹ ÎµÎ¾Î¯ÏƒÎ¿Ï… ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ Î½Î± ÏƒÎ±Ï‚ Î´ÎµÎ¯Î¾Î¿Ï…Î¼Îµ Ï„Î¹ Î´ÎµÎ½ ÎºÎ±Î»ÏÏ€Ï„ÎµÏ„Î±Î¹.
            </p>
            
            <!-- Pet Info Card -->
            <div class="pet-info-card" style="margin-bottom: 3rem;">
                <div class="pet-icon-small" id="pet-avatar">ğŸ•</div>
                <span class="pet-reminder-text" id="pet-name-display">Î¤Î¿ ÎºÎ±Ï„Î¿Î¹ÎºÎ¯Î´Î¹ÏŒ ÏƒÎ±Ï‚</span>
                <span class="gender-indicator" id="pet-gender-display">
                    <span style="color: #4A90E2;">â™‚ï¸ Î‘ÏÏƒÎµÎ½Î¹ÎºÏŒ</span>
                </span>
            </div>
            
            <!-- Selected Program Display -->
            <div class="selected-program-card" id="selected-program-display" style="margin-bottom: 3rem;">
                <div class="program-info">
                    <span class="program-label">Î•Ï€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ Î ÏÏŒÎ³ÏÎ±Î¼Î¼Î±:</span>
                    <span class="program-name" id="program-name-display">Gold</span>
                </div>
            </div>
            
            <!-- Non-Covered Conditions -->
            <div class="non-covered-container">
                <div class="non-covered-card">
                    <div class="non-covered-header">
                        <h2>ğŸš« Î¤Î¹ Î´ÎµÎ½ ÎºÎ±Î»ÏÏ€Ï„ÎµÏ„Î±Î¹</h2>
                        <p>Î“Î¹Î± Ï€Î»Î®ÏÎ· Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹Î±, Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¿ÏÎ½ Î¿Î¹ ÎµÎ¾Î±Î¹ÏÎ­ÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚:</p>
                    </div>
                    
                    <div class="non-covered-list">
                        <div class="non-covered-item">
                            <div class="item-icon">ğŸ¥</div>
                            <div class="item-content">
                                <h4>Î ÏÎ¿Ï‹Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎµÏ‚ Î® Î§ÏÏŒÎ½Î¹ÎµÏ‚ Î‘ÏƒÎ¸Î­Î½ÎµÎ¹ÎµÏ‚</h4>
                                <p>Î Î±Î¸Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Ï…Ï€Î®ÏÏ‡Î±Î½ Ï€ÏÎ¹Î½ Ï„Î·Î½ Î­Î½Î±ÏÎ¾Î· Ï„Î·Ï‚ Î±ÏƒÏ†Î¬Î»Î¹ÏƒÎ·Ï‚</p>
                            </div>
                        </div>
                        
                        <div class="non-covered-item">
                            <div class="item-icon">ğŸŒ</div>
                            <div class="item-content">
                                <h4>ÎšÎ±Ï„Î¿Î¹ÎºÎ¯Î´Î¹Î± ÎµÎºÏ„ÏŒÏ‚ Ï„Î·Ï‚ Î•Î»Î»Î¬Î´Î±Ï‚</h4>
                                <p>ÎšÎ¬Î»Ï…ÏˆÎ· Î¹ÏƒÏ‡ÏÎµÎ¹ Î¼ÏŒÎ½Î¿ ÎµÎ½Ï„ÏŒÏ‚ ÎµÎ»Î»Î·Î½Î¹ÎºÎ¿Ï ÎµÎ´Î¬Ï†Î¿Ï…Ï‚</p>
                            </div>
                        </div>
                        
                        <div class="non-covered-item">
                            <div class="item-icon">ğŸ¼</div>
                            <div class="item-content">
                                <h4>ÎšÏŒÏƒÏ„Î· ÎµÎºÏ„ÏÎ¿Ï†Î®Ï‚, ÎµÎ³ÎºÏ…Î¼Î¿ÏƒÏÎ½Î·Ï‚ ÎºÎ±Î¹ Ï„Î¿ÎºÎµÏ„Î¿Ï</h4>
                                <p>Î•Î¾Î±Î¹ÏÎ¿ÏÎ½Ï„Î±Î¹ Ï„Î± Î­Î¾Î¿Î´Î± Î±Î½Î±Ï€Î±ÏÎ±Î³Ï‰Î³Î®Ï‚ ÎºÎ±Î¹ Î³Î­Î½Î½Î±Ï‚</p>
                            </div>
                        </div>
                        
                        <div class="non-covered-item">
                            <div class="item-icon">ğŸ¦´</div>
                            <div class="item-content">
                                <h4>ÎœÎµÏ„Î±Î¼Î¿ÏƒÏ‡ÎµÏÏƒÎµÎ¹Ï‚, Ï€ÏÎ¿ÏƒÎ¸ÎµÏ„Î¹ÎºÎ¬ ÎºÎ±Î¹ ÎµÎ¼Ï†Ï…Ï„ÎµÏÎ¼Î±Ï„Î± Î±ÏÎ¸ÏÏÏƒÎµÏ‰Î½</h4>
                                <p>Î•Î¾ÎµÎ¹Î´Î¹ÎºÎµÏ…Î¼Î­Î½ÎµÏ‚ Ï‡ÎµÎ¹ÏÎ¿Ï…ÏÎ³Î¹ÎºÎ­Ï‚ ÎµÏ€ÎµÎ¼Î²Î¬ÏƒÎµÎ¹Ï‚ Ï…ÏˆÎ·Î»Î¿Ï ÎºÏŒÏƒÏ„Î¿Ï…Ï‚</p>
                            </div>
                        </div>
                        
                        <div class="non-covered-item">
                            <div class="item-icon">ğŸ§¬</div>
                            <div class="item-content">
                                <h4>Î”Ï…ÏƒÏ€Î»Î±ÏƒÎ¯ÎµÏ‚</h4>
                                <p>Î‘Î½Î±Ï€Ï„Ï…Î¾Î¹Î±ÎºÎ­Ï‚ Î´Î¹Î±Ï„Î±ÏÎ±Ï‡Î­Ï‚ Î¿ÏƒÏ„ÏÎ½ ÎºÎ±Î¹ Î±ÏÎ¸ÏÏÏƒÎµÏ‰Î½</p>
                            </div>
                        </div>
                        
                        <div class="non-covered-item">
                            <div class="item-icon">ğŸŒ¿</div>
                            <div class="item-content">
                                <h4>Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ­Ï‚ Î¸ÎµÏÎ±Ï€ÎµÎ¯ÎµÏ‚</h4>
                                <p>ÎŸÎ¼Î¿Î¹Î¿Ï€Î±Î¸Î·Ï„Î¹ÎºÎ®, Î²ÎµÎ»Î¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ ÎºÎ±Î¹ Î¬Î»Î»ÎµÏ‚ Î¼Î· ÏƒÏ…Î¼Î²Î±Ï„Î¹ÎºÎ­Ï‚ Î¸ÎµÏÎ±Ï€ÎµÎ¯ÎµÏ‚</p>
                            </div>
                        </div>
                        
                        <div class="non-covered-item">
                            <div class="item-icon">ğŸ˜¤</div>
                            <div class="item-content">
                                <h4>Î”Î¹Î±Ï„Î±ÏÎ±Ï‡Î­Ï‚ ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬Ï‚ Î® ÎµÏ€Î¹Î¸ÎµÏ„Î¹ÎºÏŒÏ„Î·Ï„Î±Ï‚</h4>
                                <p>Î¨Ï…Ï‡Î¿Î»Î¿Î³Î¹ÎºÎ¬ ÎºÎ±Î¹ ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¹ÎºÎ¬ Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î±</p>
                            </div>
                        </div>
                        
                        <div class="non-covered-item">
                            <div class="item-icon">ğŸ§ª</div>
                            <div class="item-content">
                                <h4>ÎšÎ»Î·ÏÎ¿Î½Î¿Î¼Î¹ÎºÎ­Ï‚ & Î£Ï…Î³Î³ÎµÎ½ÎµÎ¯Ï‚ Ï€Î±Î¸Î®ÏƒÎµÎ¹Ï‚</h4>
                                <p>Î“ÎµÎ½ÎµÏ„Î¹ÎºÎ­Ï‚ Î´Î¹Î±Ï„Î±ÏÎ±Ï‡Î­Ï‚ ÎºÎ±Î¹ ÎµÎº Î³ÎµÎ½ÎµÏ„Î®Ï‚ Î±Î½Ï‰Î¼Î±Î»Î¯ÎµÏ‚</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Acknowledgment Section -->
            <div class="declaration-section">
                <h3 class="declaration-title">
                    Î”Î®Î»Ï‰ÏƒÎ· Î³Î¹Î± <span id="pet-name-in-question">Ï„Î¿ ÎºÎ±Ï„Î¿Î¹ÎºÎ¯Î´Î¹ÏŒ ÏƒÎ±Ï‚</span>
                </h3>
                <p class="declaration-subtitle">
                    ÎˆÏ‡ÎµÏ„Îµ Î´Î¹Î±Î²Î¬ÏƒÎµÎ¹ ÎºÎ±Î¹ ÎºÎ±Ï„Î±Î½Î¿Î®ÏƒÎµÎ¹ Ï„Î¹Ï‚ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ Ï„Î¹ Î´ÎµÎ½ ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î±;
                </p>
                
                <div class="acknowledgment-button-container" style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-lg" id="acknowledgeBtn" onclick="acknowledgeAndContinue()" style="background: var(--brand-gradient); color: white; border: none; padding: 1.5rem 3rem; border-radius: 15px; font-weight: 600; font-size: 1.2rem; cursor: pointer; box-shadow: 0 5px 15px rgba(90, 200, 189, 0.3); transition: all 0.3s ease;">
                        ÎˆÎ»Î±Î²Î± Î“Î½ÏÏƒÎ· âœ“
                    </button>
                </div>
            </div>
            
            <!-- Navigation Buttons -->
            <div class="navigation-buttons" style="margin-top: 3rem;">
                <button class="btn btn-lg btn-light" onclick="goBack()" style="padding: 1rem 2rem; border-radius: 15px; font-weight: 600;">
                    â† Î Î¯ÏƒÏ‰ ÏƒÏ„Î± Î ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î±
                </button>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get parameters from URL
    const urlParams = new URLSearchParams(window.location.search);
    const petType = urlParams.get('type');
    const gender = urlParams.get('gender');
    const name = urlParams.get('name');
    const program = urlParams.get('program');
    const isHealthy = urlParams.get('is_healthy'); // Get is_healthy from questionnaire
    
    // Set pet avatar
    if (petType === 'dog') {
        document.getElementById('pet-avatar').textContent = 'ğŸ•';
    } else if (petType === 'cat') {
        document.getElementById('pet-avatar').textContent = 'ğŸ±';
    }
    
    // Set pet name in all places
    if (name) {
        const petName = decodeURIComponent(name);
        document.getElementById('pet-name-display').textContent = petName;
        
        // Update all name references
        const genderArticle = gender === 'male' ? 'Î¿' : 'Î·';
        document.getElementById('pet-name-in-question').textContent = `${genderArticle} ${petName}`;
        document.getElementById('pet-name-in-subtitle').textContent = `${genderArticle} ${petName}`;
        document.getElementById('pet-name-has').textContent = `${genderArticle} ${petName}`;
        document.getElementById('pet-name-none').textContent = `${genderArticle} ${petName}`;
    }
    
    // Set gender display
    if (gender === 'male') {
        document.getElementById('pet-gender-display').innerHTML = '<span style="color: #4A90E2;">â™‚ï¸ Î‘ÏÏƒÎµÎ½Î¹ÎºÏŒ</span>';
    } else if (gender === 'female') {
        document.getElementById('pet-gender-display').innerHTML = '<span style="color: #E91E63;">â™€ï¸ Î˜Î·Î»Ï…ÎºÏŒ</span>';
    }
    
    // Set selected program
    if (program) {
        const programNames = {
            'silver': 'Silver (2.000â‚¬)',
            'gold': 'Gold (3.000â‚¬)',
            'platinum': 'Platinum Dynasty (5.000â‚¬)'
        };
        
        const programDisplay = document.getElementById('program-name-display');
        programDisplay.textContent = programNames[program] || program;
        
        // Add program-specific styling
        const programCard = document.getElementById('selected-program-display');
        programCard.classList.add(`program-${program}`);
    }
    
    // Show the page - user must acknowledge before continuing
});

function acknowledgeAndContinue() {
    // Get all parameters from URL
    const urlParams = new URLSearchParams(window.location.search);
    const petType = urlParams.get('type');
    const gender = urlParams.get('gender');
    const birthdate = urlParams.get('birthdate');
    const breed = urlParams.get('breed');
    const name = urlParams.get('name');
    const program = urlParams.get('program');
    const isHealthy = urlParams.get('is_healthy'); // Get is_healthy from questionnaire
    
    // Check if pet is healthy based on questionnaire answer
    // If is_healthy is false, or if there are health issues, route to health conditions
    // Otherwise, route to user_data
    if (isHealthy === 'false' || isHealthy === false) {
        // Pet is not healthy - route to health conditions page
        selectDeclaration('has_conditions');
    } else {
        // Pet is healthy - route to user_data
        selectDeclaration('no_conditions');
    }
}

function selectDeclaration(choice) {
    // Get all parameters from URL
    const urlParams = new URLSearchParams(window.location.search);
    const petType = urlParams.get('type');
    const gender = urlParams.get('gender');
    const birthdate = urlParams.get('birthdate');
    const breed = urlParams.get('breed');
    const name = urlParams.get('name');
    const program = urlParams.get('program');
    const isHealthy = urlParams.get('is_healthy'); // Preserve is_healthy parameter
    
    if (choice === 'has_conditions') {
        // Redirect to health conditions page based on pet type
        const params = new URLSearchParams({
            type: petType || '',
            gender: gender || '',
            birthdate: birthdate || '',
            breed: breed || '',
            name: name || '',
            health_status: 'problems',
            program: program || ''
        });
        
        // Preserve is_healthy if available
        if (isHealthy) {
            params.set('is_healthy', isHealthy);
        }
        
        if (petType === 'dog') {
            window.location.href = `{% url 'main:dog_health_conditions' %}?${params.toString()}`;
        } else if (petType === 'cat') {
            window.location.href = `{% url 'main:cat_health_conditions' %}?${params.toString()}`;
        }
    } else if (choice === 'no_conditions') {
        // Continue to user data page
        const params = new URLSearchParams({
            type: petType || '',
            gender: gender || '',
            birthdate: birthdate || '',
            breed: breed || '',
            name: name || '',
            health_status: 'healthy',
            conditions: '',
            program: program || ''
        });
        
        // Preserve is_healthy if available
        if (isHealthy) {
            params.set('is_healthy', isHealthy);
        }
        
        window.location.href = `{% url 'main:user_data' %}?${params.toString()}`;
    }
}

function goBack() {
    window.history.back();
}
</script>
{% endblock %}
