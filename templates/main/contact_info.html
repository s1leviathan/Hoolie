{% extends 'base.html' %}
{% load static %}

{% block title %}Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚ - Hoolie Pet Insurance{% endblock %}

{% block content %}
<section class="hero-section">
    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title" style="font-size: 2.5rem; margin-bottom: 1rem;">
                <span style="background: linear-gradient(45deg, #ffffff, #f0f8ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    Î£Ï‡ÎµÎ´ÏŒÎ½ Ï„ÎµÎ»ÎµÎ¹ÏÏƒÎ±Î¼Îµ! ğŸ‰
                </span>
            </h1>
            
            <p class="hero-subtitle" style="font-size: 1.2rem; margin-bottom: 2rem; opacity: 0.9;">
                Î— Î¿Î¼Î¬Î´Î± Ï„Î·Ï‚ Hoolie Î¸Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎµÎ¹ Î¼Î±Î¶Î¯ ÏƒÎ±Ï‚ Î³Î¹Î± Î­Î½Î± ÎµÎ¾Î±Ï„Î¿Î¼Î¹ÎºÎµÏ…Î¼Î­Î½Î¿ Ï€Î±ÎºÎ­Ï„Î¿ Î±ÏƒÏ†Î¬Î»Î¹ÏƒÎ·Ï‚ <span id="pet-name-in-subtitle">Î³Î¹Î± Ï„Î¿ ÎºÎ±Ï„Î¿Î¹ÎºÎ¯Î´Î¹ÏŒ ÏƒÎ±Ï‚</span>
            </p>
            
            <!-- Pet Info Card -->
            <div class="pet-info-card" style="margin-bottom: 3rem;">
                <div class="pet-icon-small" id="pet-avatar">ğŸ•</div>
                <span class="pet-reminder-text" id="pet-name-display">Î¤Î¿ ÎºÎ±Ï„Î¿Î¹ÎºÎ¯Î´Î¹ÏŒ ÏƒÎ±Ï‚</span>
                <span class="gender-indicator" id="pet-gender-display">
                    <span style="color: #4A90E2;">â™‚ï¸ Î‘ÏÏƒÎµÎ½Î¹ÎºÏŒ</span>
                </span>
            </div>
            
            <!-- Email Input Form -->
            <div class="email-form-container">
                <div class="form-card">
                    <div class="form-header">
                        <h3 style="margin-bottom: 1rem; font-weight: 600;">
                            ğŸ“§ Î ÏÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎ¿Ï…Î¼Îµ Î¼Î±Î¶Î¯ ÏƒÎ±Ï‚;
                        </h3>
                        <p style="margin-bottom: 2rem;">
                            Î•Î¹ÏƒÎ±Î³Î¬Î³ÎµÏ„Îµ Ï„Î¿ email ÏƒÎ±Ï‚ Î³Î¹Î± Î½Î± Î»Î¬Î²ÎµÏ„Îµ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÏ†Î¿ÏÎ¬ ÏƒÎ±Ï‚
                        </p>
                    </div>
                    
                    <div class="email-input-group">
                        <label for="email-input" class="form-label">Email Address *</label>
                        <input 
                            type="email" 
                            id="email-input" 
                            class="form-control email-input" 
                            placeholder="Ï€.Ï‡. yourname@example.com"
                            required
                        >
                        <div class="input-feedback" id="email-feedback"></div>
                    </div>
                    
                    <div class="privacy-notice" style="margin: 1.5rem 0;">
                        <small style="font-size: 0.9rem;">
                            ğŸ”’ Î¤Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± ÏƒÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ Î±ÏƒÏ†Î±Î»Î® ÎºÎ±Î¹ Î´ÎµÎ½ Î¸Î± Î¼Î¿Î¹ÏÎ±ÏƒÏ„Î¿ÏÎ½ Î¼Îµ Ï„ÏÎ¯Ï„Î¿Ï…Ï‚
                        </small>
                    </div>
                    
                    <button 
                        class="btn btn-primary btn-lg submit-email-btn" 
                        onclick="submitEmail()"
                        style="width: 100%; padding: 1rem; font-size: 1.1rem; font-weight: 600; border-radius: 15px;"
                    >
                        Î›Î®ÏˆÎ· Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬Ï‚ ğŸš€
                    </button>
                </div>
            </div>
            
            <!-- Navigation Buttons -->
            <div class="navigation-buttons" style="margin-top: 3rem;">
                <button class="btn btn-lg btn-light me-3" onclick="goBack()" style="padding: 1rem 2rem; border-radius: 15px; font-weight: 600;">
                    â† Î Î¯ÏƒÏ‰
                </button>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get parameters from URL
    const urlParams = new URLSearchParams(window.location.search);
    const petType = urlParams.get('type');
    const gender = urlParams.get('gender');
    const name = urlParams.get('name');
    const breed = urlParams.get('breed');
    
    // Set pet avatar and name
    if (petType === 'dog') {
        document.getElementById('pet-avatar').textContent = 'ğŸ•';
    } else if (petType === 'cat') {
        document.getElementById('pet-avatar').textContent = 'ğŸ±';
    }
    
    // Set pet name
    if (name) {
        const petName = decodeURIComponent(name);
        document.getElementById('pet-name-display').textContent = petName;
        
        // Update subtitle to include pet name
        document.getElementById('pet-name-in-subtitle').textContent = `Î³Î¹Î± ${petName}`;
    }
    
    // Set gender display
    if (gender === 'male') {
        document.getElementById('pet-gender-display').innerHTML = '<span style="color: #4A90E2;">â™‚ï¸ Î‘ÏÏƒÎµÎ½Î¹ÎºÏŒ</span>';
    } else if (gender === 'female') {
        document.getElementById('pet-gender-display').innerHTML = '<span style="color: #E91E63;">â™€ï¸ Î˜Î·Î»Ï…ÎºÏŒ</span>';
    }
    
    // Email validation
    const emailInput = document.getElementById('email-input');
    const emailFeedback = document.getElementById('email-feedback');
    
    emailInput.addEventListener('input', function() {
        const email = this.value;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (email === '') {
            emailFeedback.textContent = '';
            emailFeedback.className = 'input-feedback';
        } else if (emailRegex.test(email)) {
            emailFeedback.textContent = 'âœ… ÎˆÎ³ÎºÏ…ÏÎ¿ email';
            emailFeedback.className = 'input-feedback valid';
        } else {
            emailFeedback.textContent = 'âŒ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ±Î³Î¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ email';
            emailFeedback.className = 'input-feedback invalid';
        }
    });
});

function submitEmail() {
    const emailInput = document.getElementById('email-input');
    const email = emailInput.value.trim();
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    
    if (!email) {
        alert('Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ±Î³Î¬Î³ÎµÏ„Îµ Ï„Î¿ email ÏƒÎ±Ï‚');
        emailInput.focus();
        return;
    }
    
    if (!emailRegex.test(email)) {
        alert('Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ±Î³Î¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ email');
        emailInput.focus();
        return;
    }
    
    // Get all parameters from URL
    const urlParams = new URLSearchParams(window.location.search);
    const petType = urlParams.get('type');
    const gender = urlParams.get('gender');
    const birthdate = urlParams.get('birthdate');
    const breed = urlParams.get('breed');
    const name = urlParams.get('name');
    const healthStatus = urlParams.get('health_status');
    const conditions = urlParams.get('conditions');
    
    // Navigate to thank you page with all data including email
    const params = new URLSearchParams({
        type: petType || '',
        gender: gender || '',
        birthdate: birthdate || '',
        breed: breed || '',
        name: name || '',
        health_status: healthStatus || '',
        conditions: conditions || '',
        email: email
    });
    
    window.location.href = `{% url 'main:thank_you' %}?${params.toString()}`;
}

function goBack() {
    window.history.back();
}
</script>
{% endblock %}
