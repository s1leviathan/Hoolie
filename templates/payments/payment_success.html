{% extends 'main/base.html' %}
{% load static %}

{% block title %}Î•Ï€Î¹Ï„Ï…Ï‡Î®Ï‚ Î Î»Î·ÏÏ‰Î¼Î® - {{ application.contract_number }}{% endblock %}

{% block extra_css %}
<style>
    .success-container {
        max-width: 600px;
        margin: 50px auto;
        padding: 20px;
        text-align: center;
    }
    
    .success-icon {
        font-size: 80px;
        color: #28a745;
        margin-bottom: 20px;
        animation: bounce 1s ease-in-out;
    }
    
    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-10px); }
        60% { transform: translateY(-5px); }
    }
    
    .success-title {
        color: #28a745;
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 15px;
    }
    
    .success-message {
        font-size: 18px;
        color: #666;
        margin-bottom: 30px;
        line-height: 1.6;
    }
    
    .payment-details {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 12px;
        padding: 25px;
        margin: 30px 0;
        text-align: left;
    }
    
    .detail-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #eee;
    }
    
    .detail-row:last-child {
        border-bottom: none;
        font-weight: bold;
        font-size: 18px;
        color: #5ac8bd;
        margin-top: 10px;
        padding-top: 15px;
        border-top: 2px solid #5ac8bd;
    }
    
    .detail-label {
        color: #666;
        font-weight: 500;
    }
    
    .detail-value {
        color: #333;
        font-weight: bold;
    }
    
    .next-steps {
        background: linear-gradient(135deg, #5ac8bd, #4a9d94);
        color: white;
        padding: 25px;
        border-radius: 12px;
        margin: 30px 0;
    }
    
    .next-steps h4 {
        margin: 0 0 15px 0;
        font-size: 20px;
    }
    
    .next-steps ul {
        text-align: left;
        margin: 0;
        padding-left: 20px;
    }
    
    .next-steps li {
        margin-bottom: 8px;
        line-height: 1.5;
    }
    
    .action-buttons {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-top: 30px;
    }
    
    .btn {
        padding: 12px 24px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        text-align: center;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
        font-size: 16px;
    }
    
    .btn-primary {
        background: linear-gradient(135deg, #5ac8bd, #4a9d94);
        color: white;
    }
    
    .btn-secondary {
        background: white;
        color: #5ac8bd;
        border: 2px solid #5ac8bd;
    }
    
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .email-info {
        background: #e3f2fd;
        border: 1px solid #bbdefb;
        border-radius: 8px;
        padding: 15px;
        margin: 20px 0;
        font-size: 14px;
        color: #1565c0;
    }
    
    @media (max-width: 768px) {
        .success-container {
            margin: 20px auto;
            padding: 15px;
        }
        
        .action-buttons {
            grid-template-columns: 1fr;
        }
        
        .success-icon {
            font-size: 60px;
        }
        
        .success-title {
            font-size: 24px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="success-container">
    <div class="success-icon">âœ…</div>
    
    <h1 class="success-title">Î— Î Î»Î·ÏÏ‰Î¼Î® ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ Î•Ï€Î¹Ï„Ï…Ï‡ÏÏ‚!</h1>
    
    <p class="success-message">
        Î£Ï…Î³Ï‡Î±ÏÎ·Ï„Î®ÏÎ¹Î±! Î— Î±ÏƒÏ†Î¬Î»Î¹ÏƒÎ· Ï„Î¿Ï… ÎºÎ±Ï„Î¿Î¹ÎºÎ¹Î´Î¯Î¿Ï… ÏƒÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ Ï€Î»Î­Î¿Î½ ÎµÎ½ÎµÏÎ³Î®. 
        Î˜Î± Î»Î¬Î²ÎµÏ„Îµ email ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ·Ï‚ Î¼Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚.
    </p>
    
    <div class="payment-details">
        <div class="detail-row">
            <span class="detail-label">Î£Ï…Î¼Î²ÏŒÎ»Î±Î¹Î¿:</span>
            <span class="detail-value">{{ application.contract_number }}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Î™Î´Î¹Î¿ÎºÏ„Î®Ï„Î·Ï‚:</span>
            <span class="detail-value">{{ application.full_name }}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">ÎšÎ±Ï„Î¿Î¹ÎºÎ¯Î´Î¹Î¿:</span>
            <span class="detail-value">{{ application.pet_name }} ({{ application.get_pet_type_display_greek }})</span>
        </div>
        {% if application.has_second_pet %}
        <div class="detail-row">
            <span class="detail-label">2Î¿ ÎšÎ±Ï„Î¿Î¹ÎºÎ¯Î´Î¹Î¿:</span>
            <span class="detail-value">{{ application.second_pet_name }}</span>
        </div>
        {% endif %}
        <div class="detail-row">
            <span class="detail-label">Î ÏÏŒÎ³ÏÎ±Î¼Î¼Î±:</span>
            <span class="detail-value">{{ application.get_program_display_greek }}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Î¤ÏÏ€Î¿Ï‚ Î Î»Î·ÏÏ‰Î¼Î®Ï‚:</span>
            <span class="detail-value">{{ payment.get_payment_type_display }}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎˆÎ½Î±ÏÎ¾Î·Ï‚:</span>
            <span class="detail-value">{{ application.contract_start_date|date:"d/m/Y" }}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î›Î®Î¾Î·Ï‚:</span>
            <span class="detail-value">{{ application.contract_end_date|date:"d/m/Y" }}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ Î Î¿ÏƒÏŒ:</span>
            <span class="detail-value">{{ payment.amount }}â‚¬</span>
        </div>
    </div>
    
    <div class="email-info">
        ğŸ“§ Î˜Î± Î»Î¬Î²ÎµÏ„Îµ email ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ·Ï‚ ÏƒÏ„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· <strong>{{ application.email }}</strong> 
        Î¼Îµ Ï„Î¿ ÏƒÏ…Î¼Î²ÏŒÎ»Î±Î¹ÏŒ ÏƒÎ±Ï‚ ÎºÎ±Î¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚ Ï„Î·Ï‚ ÎºÎ¬Î»Ï…ÏˆÎ·Ï‚.
    </div>
    
    <div class="next-steps">
        <h4>ğŸ‰ Î¤Î¹ Î‘ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯;</h4>
        <ul>
            <li>Î— Î±ÏƒÏ†Î¬Î»Î¹ÏƒÎ® ÏƒÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ Î¬Î¼ÎµÏƒÎ± ÎµÎ½ÎµÏÎ³Î®</li>
            <li>ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ ÏƒÏ…Î¼Î²ÏŒÎ»Î±Î¹ÏŒ ÏƒÎ±Ï‚ Î±Ï€ÏŒ Ï„Î¿ email</li>
            <li>Î£Îµ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î±Î½Î¬Î³ÎºÎ·Ï‚, ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÏ„Îµ Î¼Î±Î¶Î¯ Î¼Î±Ï‚ ÏƒÏ„Î¿ 210-1234567</li>
            <li>ÎšÏÎ±Ï„Î®ÏƒÏ„Îµ Ï„Î¿Î½ Î±ÏÎ¹Î¸Î¼ÏŒ ÏƒÏ…Î¼Î²Î¿Î»Î±Î¯Î¿Ï… ÏƒÎ±Ï‚ Î³Î¹Î± Î¼ÎµÎ»Î»Î¿Î½Ï„Î¹ÎºÎ® Î±Î½Î±Ï†Î¿ÏÎ¬</li>
        </ul>
    </div>
    
    <div class="action-buttons">
        <a href="{% url 'main:index' %}" class="btn btn-secondary">
            ğŸ  Î‘ÏÏ‡Î¹ÎºÎ® Î£ÎµÎ»Î¯Î´Î±
        </a>
        <a href="mailto:info@hoolie.gr?subject=Î£Ï…Î¼Î²ÏŒÎ»Î±Î¹Î¿ {{ application.contract_number }}" class="btn btn-primary">
            ğŸ“§ Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±
        </a>
    </div>
</div>

<script>
// Auto-refresh payment status if still pending
{% if not payment.is_successful %}
setTimeout(function() {
    fetch(`/payments/status/{{ payment.id }}/`)
        .then(response => response.json())
        .then(data => {
            if (data.is_successful) {
                location.reload();
            }
        })
        .catch(error => console.log('Status check failed:', error));
}, 5000);
{% endif %}

// Confetti animation
function createConfetti() {
    const colors = ['#5ac8bd', '#28a745', '#ffc107', '#17a2b8'];
    const confettiCount = 50;
    
    for (let i = 0; i < confettiCount; i++) {
        const confetti = document.createElement('div');
        confetti.style.position = 'fixed';
        confetti.style.left = Math.random() * 100 + 'vw';
        confetti.style.top = '-10px';
        confetti.style.width = '10px';
        confetti.style.height = '10px';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.pointerEvents = 'none';
        confetti.style.zIndex = '9999';
        confetti.style.borderRadius = '50%';
        
        document.body.appendChild(confetti);
        
        const animation = confetti.animate([
            { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
            { transform: `translateY(100vh) rotate(360deg)`, opacity: 0 }
        ], {
            duration: Math.random() * 2000 + 1000,
            easing: 'ease-out'
        });
        
        animation.onfinish = () => confetti.remove();
    }
}

// Trigger confetti on page load
{% if payment.is_successful %}
setTimeout(createConfetti, 500);
{% endif %}
</script>
{% endblock %}



